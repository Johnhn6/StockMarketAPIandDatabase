# StockMarketAPIandDatabase
Using AlphaVantage.com's API as well as Java and MySQL, the application is able to get data from AlphaVantage's API about the stock market and store it, while giving information based on what the user inputs. The information stored is focused on a stock's opening value, closing value, highest value, and lowest value of that day, as well as calculating the gains or losses based on specific days. The historical records and storation of the data go back to 11/1/1999.

# How to Use
First, make sure you have MySQL and Java set up. Within the files there is a lib folder. The lib folder contains jar files of external libraries that were needed for the application to perform. The java simple jar file is there to help process JSON data structures that are retrieved from the API, and the MySQL connector jar file is there to help connect and perform functions from your java files to your MySQL database. Once you download the code, use the SQL script in your MySQL workbench in order to create the necessary schema and tables. Please do not change the names of the tables as they are used in the application's insert and search functions. In addition, please record your database's url, username, and password. All of this can be found in the edit connection of your MySQL workbench. The url should look like jdbc:mysql://localhost:3306/stockmarket. After that, get a free API key from https://www.alphavantage.co/support/. Now use a java IDE of your choice, and make sure the jar files in the lib folder are in the build path and are in the referenced library, depending on the IDE you are using. The files with programs that you run or edit are in the src folder. In the src folder, you can run the App file. The App file has a main function, so that one runs the program. Follow the directions, and it will ask for your API key and MySQL login information that you recorded earlier. In the program, there will be instructions that will be printed and a list of commands you can do at certain moments, so please follow them. Currently, you do have to look up the stock symbols beforehand. To see an example, you can use the "IBM" stock as a stock to look up.

HUGE DISCLAIMER: If you are looking up a stock that is not in the database, then it will insert all the available data into your database. This will take a while, so please be patient. I tested "IBM" and I got to around 27 minutes, but that was with a print statement each time as I was debugging the program. The next search on IBM only took .01 secs. As your database grows, the time needed will decrease, but the initial time for a new stock will take quite a while.

# Overview of Programs, Reflection, and Uses
The project was a good learning experience. Through it, I was able to practice java, SQL, API usage, JSON, and practise how to connect to the MySQL database from my java program. I faced some difficulties, such as learning how to use external libraries such as jar files, and specifically how to install them. Unfortunately, one of the IDEs I tried first could not find it despite being in the referenced library, but the Eclipse IDE was able to do it, and I finished the project with that IDE. In order to practice good SQL methodology, I used prepared statements for my queries and updates that prevent SQL injections. Despite learning about prepared statements beforehand, I did not know that the ? symbol can only be used for values. In prepared statements, we replace the values in the string with ?, and then we set it separately. I tried using it for one of my tables, but it was not the correct methodology and can be susceptible to SQL injections. Going through JSON is essentially like going through a map or dictionary. But one issue that I faced was how to store the data within variables from the API stream. I learned how to do so by slowly adding it to a string and then changing that string back into a JSON data structure. I mistake that I made was not understanding that the stream was giving me the information about how it looked like a JSON object, and so I did not realize that there is methods to turn it back to JSON from a string. I attempted to map it using the Jackson jar files, but found it much easier to put it back into a JSON object instead and then treat it like a map or dictionary.

The stockMarket.java is an interface. Interfaces in java are an abstract class that you can use in inheritance. I initially thought I was going to make two classes that inherit from the interface, but ended up going with one class as I found myself just inputting all the data instead of just inputting a specific date, especially with the low number of daily use. In the end, while I didn't really need an interface or superclass anymore, I felt it was good practice to use the programming technique of inheritance, and understanding when to use it.

The sqlCommands.java handles all the database manipulation. It sets up everything such as the driver and the connection to the database. One thing that I had to review was how to connect back to the database, and that involves having a driver connector, which is the MySQL connector jar file in your lib folder that should be in your referenced folder. After that, prepared statements are used to make the statements and then later execute the statements that will perform the action of your queries. A ResultSet is sent back with information about what you found or updated. In order to go through it, you must treat it like a stream and do next(). To determine if it was empty, which tells you that there is no row/datapoint of that specific search, then you can do !ResultSetObject.isBeforeFirst() which tells you if it's already at the end despite not doing next(). The program has sqlInsert() that inserts the parameters given to it in each of the 4 tables that has opening, closing, high, and low values. The sqlGet() searches for it and if it doesn't have the row/datapoint then it will run sqlnext() to insert it. The parameters the methods are getting are the actual JSON data that we will handle in dailyStockMarket.java, and so they are the actual data points and should be inserted, although you could technically insert or search for anything as long as you put the correct objects in the parameters. There is also a SQL delete function, but they went unused and are only there if you want to personally clean up your tables without going to your MySQL workbench. They are not in the user inputs, so you will have to put the methods in the App.java and run them there with the correct information you want to delete.

The dailyStockMarket.java handles your JSON data. There are four functions that give you each of the 4 values of a stock on a specific day, called opening(), closing(), highestValue(), and lowestValue(). They use the sqlCommands.java to search if it is in the database, and if not, then they do apiGetJsonData() which gives them a nested HashMap, which is a map with the value being another map like {string, {string : string}}. On the outer map, the key is the date. In the inner map, there are the 4 values, where the values are the values of each of the 4 values. apiGetJsonData() would then run sqlCommands.java sqlGet(), which will insert the data if it is not there. The function will also return a hashmap which is then used to print the value you are looking for. For example, opening() will print the opening value of a stock on a specific date you chose. There are also functions to set up the API key and MySQL login info that you will send to sqlCommands.java whenever you call them. apiGetJsonData() will also perform the necessary steps to connect to the API, which is similar to python but requires extra steps.

The App.java is the user input and contains the main method that will run when you run the program. It will ask for your API key and MySQL login info, which will then allow you to perform certain commands. The UI explains what commands you can do and will give you instructions and what to do.

# Potential Future Updates
- Creation of a front end application using HTML and JavaScript.
- Exception raised if you go beyond your limit. I did not make one as I did not go beyond the monthly limit.
- Check if the user inputs a date that is before 11/1/1999 or after 3 days before the current day and is of the correct format. Based on my research, the Dateformat, Date, and LocalDateTime classes can help.
- AlphaVantage's API also has a search text method. I can in the future use this to help users search for stocks that they would like to input. Currently, you have to look up the stock's symbol in order to input it.
- Will repond with an error mesage if a wrong stock and date is inputted.

# Thank You
Special thanks to AlphaVantage.com for allowing use of their API with a free daily option of 25 uses. Also, special thanks to the creator of JSON Simple, I believe the person is fangyidong, as I used the .jar file to deal with the JSON structure that the AlphaVantage.com API gives you. This program is not meant to be for profit and is meant for personal use.
